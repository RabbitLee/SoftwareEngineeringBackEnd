# 详细设计

## 登录
### 前端->后端
post:   

    url: http://rabbitlee.me/isUserValid,
    data: {
        name: string,
        password: string
    }

    returnValue: {
        isValid: boolean
    }

### 后端->数据库

    def isUserValid(name, password):
        ...
        return { boolean }


## 注册
### 前端->后端
post:

    url: http://rabbitlee.me/register,
    data: {
        name: string,
        password: string,
        email: string,
        phone: int(11)
    }

    returnValue: {
        isValid: boolean       // 用户名是否重复
    }

### 后端->数据库

    def register(name, password, email, phone) {
        ...
        return { boolean }      // 用户名是否重复
    }


## 选择城市
### 前端->后端
post: //  获取高德开发者账号

    url: http://rabbitlee.me/getGaodeDeveloperKey,
    data: {
        null
    }

    returnValue: {
        key: string
    }

post: // 选择省份

    url: http://rabbitlee.me/getAllProvinces,
    data: {
        null
    }

    returnValue: {
        provinces: [‘provinceName1’, 'provinceName2', ...]
    }

post: // 选择城市

    url: http://rabbitlee.me/getAllCities,
    data: {
        provinceName: string
    }

    returnValue: {
        cities: ['cityName1', 'cityName2', ...]
    }

post: // 选择景点

    url: http://rabbitlee.me/getAllSpots,
    data: {
        cityName: string
    }

    returnValue: {
        certerPosition: [lng, lat],
        spots: [{name: 'spotName1', id: string, visit_time: int},
            {name: 'spotName2', id: string， visit_time: int},
            ...]，   // visit_time 单位为分钟
        recommendedSpots: [id1, id2, ...]
    }

post: // 提交

    url: http://rabbitlee.me/submitSelectedSpots,
    data: {
        start_date: string,
        end_date: string,
        spots_id: [id1, id2, ...]
    }

    returnValue: {

    }

### 后端->数据库

    # 选择省份
    def getAllProvinces():
        ...
        return ['provinceName1', 'provinceName2', ...]

    # 选择城市
    def getAllCities(provinceName):
        ...
        return {
            cities: ['cityName1', 'cityName2', ...]
        }

    # 选择景点
    def getAllSpots(cityName):
        ...
        return {
            centerPosition: [lng, lat],
            spots: [{name: 'spotName1', id: string, visit_time: int, lngLat: [lng, lat]},
                {name: 'spotName2', id: string， visit_time: int, lngLat: [lng, lat]},
                ...]，   // visit_time 单位为分钟
            recommendedSpots: [id1, id2, ...]
        }

+ getKey
+ cityCenter
