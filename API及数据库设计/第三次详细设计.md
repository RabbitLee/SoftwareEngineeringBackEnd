# 详细设计

## 用户中心

### ejs

### 前端->后端
**prefix: /square**

post://展示当前用户拥有的路线列表

```javascript
    url: http://rabbitlee.me/personInfo/showRouteInPage
    data: {
        page: int
        userID: //ejs
    }

    returnValue: {
        pageCount: int,
        list: [{routeID: id1, creator: username1, date:[start_date1, end_date1], city: cityname1, spot: [start_spot1, end_spot1]},
        {routeID: id2, creator: username2, date:[start_date2, end_date2], city: cityname2, spot: [start_spot2, end_spot2]}, ...]
    }
```


post: //展示当前用户拥有的旅行团列表

    url: http://rabbitlee.me/personInfo/showAllAgency
    data: {
        page: int
        userID: //ejs
    }

    returnValue: {
        pageCount: int,
        list: [{routeID: id1, agency: agencyname1, date:[start_date1, end_date1], city: cityname1, state: string},
        {routeID: id2, agency: agencyname2, date:[start_date2, end_date2], city: cityname2, state: string}, ...]
    }

post: //展示旅行团拥有的路线

    url: http://rabbitlee.me/agencyPersonInfo/showAgencyRoute
    data: {
        page: int
        agencyname: //ejs
    }

    returnValue: {
        pageCount: int,
        list: [{routeID: id1, creator: username1, date:[start_date1, end_date1], city: cityname1, spot: [start_spot1, end_spot1]},
        {routeID: id2, creator: username2, date:[start_date2, end_date2], city: cityname2, spot: [start_spot2, end_spot2]}, ...]
    }
post: //展示旅行团选择的路线  

    url: http://rabbitlee.me/agencyPersonInfo/getSelectedRoute
    data: {
        agencyname: string, //ejs
        detailRouteID: string
    }

    returnValue: {
        routeId: //详细route的Id
        creator: string,
        city: string,
        participants: [[userName1, email1, state1], [userName2, email2, state2] ...],

        agency: [{agencyID: 'agency1', fare: int, poll: int}, {agencyID: 'agency2', fare: int, poll: int}, ...],
        spots_id: [[id1_1, id1_2, ...],[id2_1, id2_2, ...], ...],
        time: [[[start_time1_1, end_time1_1], [start_time1_2, endtime1_2], ...], ...],
        date: [start_date, end_date],
        spotsName: [[name1_1, name1_2, ...], ...],
        coordinate: [[[x1_1, y1_1], [x1_2, y1_2], ...], ...]        
    }

### 后端->数据库
**file position: database/personalInfoOperate.py**

//展示当前用户拥有的路线列表

    def showRouteInPage(userID):
        ...
        return {
             list: [{routeID: id1, creator: username1, date:[start_date1, end_date1], city: cityname1, spot: [start_spot1, end_spot1]},
        {routeID: id2, creator: username2, date:[start_date2, end_date2], city: cityname2, spot: [start_spot2, end_spot2]}, ...]
        }
//展示当前用户拥有的旅行团列表

    def showAllAgency(userID):
        ...
        return {
             list: [{routeID: id1, agency: agencyname1, date:[start_date1, end_date1], city: cityname1, state: string},
        {routeID: id2, agency: agencyname2, date:[start_date2, end_date2], city: cityname2, state: string}, ...]
        }

 //展示旅行团拥有的路线  

    def showAgencyRoute(agencyname):
        ...
        return {        list: [{routeID: id1, creator: username1, date:[start_date1, end_date1], city: cityname1, spot: [start_spot1, end_spot1]},
        {routeID: id2, creator: username2, date:[start_date2, end_date2], city: cityname2, spot: [start_spot2, end_spot2]}, ...]}

**file position: database/squareOperate.py**  
//展示旅行团选择的路线  

    def getSelectedRoute(agencyname,detailRouteID):
        ...
        return {
             routeId: //详细route的Id
        creator: string,
        city: string,
        participants: [[userName1, email1, state1], [userName2, email2, state2] ...],

        agency: [{agencyID: 'agency1', fare: int, poll: int}, {agencyID: 'agency2', fare: int, poll: int}, ...],
        spots_id: [[id1_1, id1_2, ...],[id2_1, id2_2, ...], ...],
        time: [[[start_time1_1, end_time1_1], [start_time1_2
